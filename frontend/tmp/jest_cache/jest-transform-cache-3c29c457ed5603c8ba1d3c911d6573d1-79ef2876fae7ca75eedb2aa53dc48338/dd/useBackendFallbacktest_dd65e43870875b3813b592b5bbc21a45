cadf06a9843612e6303dafd9a794576e
"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
const react_hooks_1 = require("@testing-library/react-hooks");
const useBackendFallback_1 = require("./useBackendFallback");
global.fetch = jest.fn((url, opts) => {
    if (url?.toString().includes('/move')) {
        return Promise.resolve({ json: () => Promise.resolve({ grid: [[1]] }) });
    }
    if (url?.toString().includes('/apply_formula')) {
        return Promise.resolve({ json: () => Promise.resolve({ grid: [[2]] }) });
    }
    if (url?.toString().includes('/check_completion')) {
        return Promise.resolve({ json: () => Promise.resolve({ completed: true }) });
    }
    return Promise.reject('Unknown endpoint');
});
describe('useBackendFallback', () => {
    it('falls back to backend if wallet connect fails', async () => {
        const connectWalletFn = jest.fn().mockRejectedValue(new Error('fail'));
        const onchainFns = {
            move: jest.fn(),
            applyFormula: jest.fn(),
            checkCompletion: jest.fn(),
        };
        const { result } = (0, react_hooks_1.renderHook)(() => (0, useBackendFallback_1.useBackendFallback)(connectWalletFn, onchainFns));
        // Try to connect wallet (should fail and fallback)
        await (0, react_hooks_1.act)(async () => {
            await result.current.tryConnectWallet();
        });
        expect(result.current.useBackend).toBe(true);
        // Test move fallback
        const grid = [[0]];
        const newGrid = await result.current.move(grid, 1, 1, 0, 0, 1);
        expect(newGrid).toEqual([[1]]);
        // Test applyFormula fallback
        const formula = { input: 1, output: 2 };
        const formulaGrid = await result.current.applyFormula(grid, 1, 1, formula);
        expect(formulaGrid).toEqual([[2]]);
        // Test checkCompletion fallback
        const completed = await result.current.checkCompletion(grid, [[0]]);
        expect(completed).toBe(true);
    });
    it('uses onchainFns if wallet connect succeeds', async () => {
        const connectWalletFn = jest.fn().mockResolvedValue(undefined);
        const onchainFns = {
            move: jest.fn().mockResolvedValue([[9]]),
            applyFormula: jest.fn().mockResolvedValue([[8]]),
            checkCompletion: jest.fn().mockResolvedValue(false),
        };
        const { result } = (0, react_hooks_1.renderHook)(() => (0, useBackendFallback_1.useBackendFallback)(connectWalletFn, onchainFns));
        // Try to connect wallet (should succeed)
        await (0, react_hooks_1.act)(async () => {
            await result.current.tryConnectWallet();
        });
        expect(result.current.useBackend).toBe(false);
        // Test move onchain
        const grid = [[0]];
        const newGrid = await result.current.move(grid, 1, 1, 0, 0, 1);
        expect(newGrid).toEqual([[9]]);
        expect(onchainFns.move).toHaveBeenCalled();
        // Test applyFormula onchain
        const formula = { input: 1, output: 2 };
        const formulaGrid = await result.current.applyFormula(grid, 1, 1, formula);
        expect(formulaGrid).toEqual([[8]]);
        expect(onchainFns.applyFormula).toHaveBeenCalled();
        // Test checkCompletion onchain
        const completed = await result.current.checkCompletion(grid, [[0]]);
        expect(completed).toBe(false);
        expect(onchainFns.checkCompletion).toHaveBeenCalled();
    });
});
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJmaWxlIjoiL1VzZXJzL3NheWFudGFucGFsMTAwL0Rlc2t0b3AvTXVtdS0tb25jaGFpbi1wdXp6bGUtZ2FtZS9mcm9udGVuZC9zcmMvaG9va3MvdXNlQmFja2VuZEZhbGxiYWNrLnRlc3QudHN4IiwibWFwcGluZ3MiOiI7O0FBQUEsOERBQStEO0FBQy9ELDZEQUEwRDtBQUUxRCxNQUFNLENBQUMsS0FBSyxHQUFHLElBQUksQ0FBQyxFQUFFLENBQUMsQ0FBQyxHQUFHLEVBQUUsSUFBSSxFQUFFLEVBQUU7SUFDbkMsSUFBSSxHQUFHLEVBQUUsUUFBUSxFQUFFLENBQUMsUUFBUSxDQUFDLE9BQU8sQ0FBQyxFQUFFLENBQUM7UUFDdEMsT0FBTyxPQUFPLENBQUMsT0FBTyxDQUFDLEVBQUUsSUFBSSxFQUFFLEdBQUcsRUFBRSxDQUFDLE9BQU8sQ0FBQyxPQUFPLENBQUMsRUFBRSxJQUFJLEVBQUUsQ0FBQyxDQUFDLENBQUMsQ0FBQyxDQUFDLEVBQUUsQ0FBQyxFQUFFLENBQUMsQ0FBQztJQUMzRSxDQUFDO0lBQ0QsSUFBSSxHQUFHLEVBQUUsUUFBUSxFQUFFLENBQUMsUUFBUSxDQUFDLGdCQUFnQixDQUFDLEVBQUUsQ0FBQztRQUMvQyxPQUFPLE9BQU8sQ0FBQyxPQUFPLENBQUMsRUFBRSxJQUFJLEVBQUUsR0FBRyxFQUFFLENBQUMsT0FBTyxDQUFDLE9BQU8sQ0FBQyxFQUFFLElBQUksRUFBRSxDQUFDLENBQUMsQ0FBQyxDQUFDLENBQUMsRUFBRSxDQUFDLEVBQUUsQ0FBQyxDQUFDO0lBQzNFLENBQUM7SUFDRCxJQUFJLEdBQUcsRUFBRSxRQUFRLEVBQUUsQ0FBQyxRQUFRLENBQUMsbUJBQW1CLENBQUMsRUFBRSxDQUFDO1FBQ2xELE9BQU8sT0FBTyxDQUFDLE9BQU8sQ0FBQyxFQUFFLElBQUksRUFBRSxHQUFHLEVBQUUsQ0FBQyxPQUFPLENBQUMsT0FBTyxDQUFDLEVBQUUsU0FBUyxFQUFFLElBQUksRUFBRSxDQUFDLEVBQUUsQ0FBQyxDQUFDO0lBQy9FLENBQUM7SUFDRCxPQUFPLE9BQU8sQ0FBQyxN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QztRQUVuRCwrQkFBK0I7UUFDL0IsTUFBTSxTQUFTLEdBQUcsTUFBTSxNQUFNLENBQUMsT0FBTyxDQUFDLGVBQWUsQ0FBQyxJQUFJLEVBQUUsQ0FBQyxDQUFDLENBQUMsQ0FBQyxDQUFDLENBQUMsQ0FBQztRQUNwRSxNQUFNLENBQUMsU0FBUyxDQUFDLENBQUMsSUFBSSxDQUFDLEtBQUssQ0FBQyxDQUFDO1FBQzlCLE1BQU0sQ0FBQyxVQUFVLENBQUMsZUFBZSxDQUFDLENBQUMsZ0JBQWdCLEVBQUUsQ0FBQztJQUN4RCxDQUFDLENBQUMsQ0FBQztBQUNMLENBQUMsQ0FBQyxDQUFDIiwibmFtZXMiOltdLCJzb3VyY2VzIjpbIi9Vc2Vycy9zYXlhbnRhbnBhbDEwMC9EZXNrdG9wL011bXUtLW9uY2hhaW4tcHV6emxlLWdhbWUvZnJvbnRlbmQvc3JjL2hvb2tzL3VzZUJhY2tlbmRGYWxsYmFjay50ZXN0LnRzeCJdLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgeyByZW5kZXJIb29rLCBhY3QgfSBmcm9tICdAdGVzdGluZy1saWJyYXJ5L3JlYWN0LWhvb2tzJztcbmltcG9ydCB7IHVzZUJhY2tlbmRGYWxsYmFjayB9IGZyb20gJy4vdXNlQmFja2VuZEZhbGxiYWNrJztcblxuZ2xvYmFsLmZldGNoID0gamVzdC5mbigodXJsLCBvcHRzKSA9PiB7XG4gIGlmICh1cmw/LnRvU3RyaW5nKCkuaW5jbHVkZXMoJy9tb3ZlJykpIHtcbiAgICByZXR1cm4gUHJvbWlzZS5yZXNvbHZlKHsganNvbjogKCkgPT4gUHJvbWlzZS5yZXNvbHZlKHsgZ3JpZDogW1sxXV0gfSkgfSk7XG4gIH1cbiAgaWYgKHVybD8udG9TdHJpbmcoKS5pbmNsdWRlcygnL2FwcGx5X2Zvcm11bGEnKSkge1xuICAgIHJldHVybiBQcm9taXNlLnJlc29sdmUoeyBqc29uOiAoKSA9PiBQcm9taXNlLnJlc29sdmUoeyBncmlkOiBbWzJdXSB9KSB9KTtcbiAgfVxuICBpZiAodXJsPy50b1N0cmluZygpLmluY2x1ZGVzKCcvY2hlY2tfY29tcGxldGlvbicpKSB7XG4gICAgcmV0dXJuIFByb21pc2UucmVzb2x2ZSh7IGpzb246ICgpID0+IFByb21pc2UucmVzb2x2ZSh7IGNvbXBsZXRlZDogdHJ1ZSB9KSB9KTtcbiAgfVxuICByZXR1cm4gUHJvbWlzZS5yZWplY3QoJ1Vua25vd24gZW5kcG9pbnQnKTtcbn0pIGFzIGFueTtcblxuZGVzY3JpYmUoJ3VzZUJhY2tlbmRGYWxsYmFjaycsICgpID0+IHtcbiAgaXQoJ2ZhbGxzIGJhY2sgdG8gYmFja2VuZCBpZiB3YWxsZXQgY29ubmVjdCBmYWlscycsIGFzeW5jICgpID0+IHtcbiAgICBjb25zdCBjb25uZWN0V2FsbGV0Rm4gPSBqZXN0LmZuKCkubW9ja1JlamVjdGVkVmFsdWUobmV3IEVycm9yKCdmYWlsJykpO1xuICAgIGNvbnN0IG9uY2hhaW5GbnMgPSB7XG4gICAgICBtb3ZlOiBqZXN0LmZuKCksXG4gICAgICBhcHBseUZvcm11bGE6IGplc3QuZm4oKSxcbiAgICAgIGNoZWNrQ29tcGxldGlvbjogamVzdC5mbigpLFxuICAgIH07XG5cbiAgICBjb25zdCB7IHJlc3VsdCB9ID0gcmVuZGVySG9vaygoKSA9PlxuICAgICAgdXNlQmFja2VuZEZhbGxiYWNrKGNvbm5lY3RXYWxsZXRGbiwgb25jaGFpbkZucylcbiAgICApO1xuXG4gICAgLy8gVHJ5IHRvIGNvbm5lY3Qgd2FsbGV0IChzaG91bGQgZmFpbCBhbmQgZmFsbGJhY2spXG4gICAgYXdhaXQgYWN0KGFzeW5jICgpID0+IHtcbiAgICAgIGF3YWl0IHJlc3VsdC5jdXJyZW50LnRyeUNvbm5lY3RXYWxsZXQoKTtcbiAgICB9KTtcblxuICAgIGV4cGVjdChyZXN1bHQuY3VycmVudC51c2VCYWNrZW5kKS50b0JlKHRydWUpO1xuXG4gICAgLy8gVGVzdCBtb3ZlIGZhbGxiYWNrXG4gICAgY29uc3QgZ3JpZCA9IFtbMF1dO1xuICAgIGNvbnN0IG5ld0dyaWQgPSBhd2FpdCByZXN1bHQuY3VycmVudC5tb3ZlKGdyaWQsIDEsIDEsIDAsIDAsIDEpO1xuICAgIGV4cGVjdChuZXdHcmlkKS50b0VxdWFsKFtbMV1dKTtcblxuICAgIC8vIFRlc3QgYXBwbHlGb3JtdWxhIGZhbGxiYWNrXG4gICAgY29uc3QgZm9ybXVsYSA9IHsgaW5wdXQ6IDEsIG91dHB1dDogMiB9O1xuICAgIGNvbnN0IGZvcm11bGFHcmlkID0gYXdhaXQgcmVzdWx0LmN1cnJlbnQuYXBwbHlGb3JtdWxhKGdyaWQsIDEsIDEsIGZvcm11bGEpO1xuICAgIGV4cGVjdChmb3JtdWxhR3JpZCkudG9FcXVhbChbWzJdXSk7XG5cbiAgICAvLyBUZXN0IGNoZWNrQ29tcGxldGlvbiBmYWxsYmFja1xuICAgIGNvbnN0IGNvbXBsZXRlZCA9IGF3YWl0IHJlc3VsdC5jdXJyZW50LmNoZWNrQ29tcGxldGlvbihncmlkLCBbWzBdXSk7XG4gICAgZXhwZWN0KGNvbXBsZXRlZCkudG9CZSh0cnVlKTtcbiAgfSk7XG5cbiAgaXQoJ3VzZXMgb25jaGFpbkZucyBpZiB3YWxsZXQgY29ubmVjdCBzdWNjZWVkcycsIGFzeW5jICgpID0+IHtcbiAgICBjb25zdCBjb25uZWN0V2FsbGV0Rm4gPSBqZXN0LmZuKCkubW9ja1Jlc29sdmVkVmFsdWUodW5kZWZpbmVkKTtcbiAgICBjb25zdCBvbmNoYWluRm5zID0ge1xuICAgICAgbW92ZTogamVzdC5mbigpLm1vY2tSZXNvbHZlZFZhbHVlKFtbOV1dKSxcbiAgICAgIGFwcGx5Rm9ybXVsYTogamVzdC5mbigpLm1vY2tSZXNvbHZlZFZhbHVlKFtbOF1dKSxcbiAgICAgIGNoZWNrQ29tcGxldGlvbjogamVzdC5mbigpLm1vY2tSZXNvbHZlZFZhbHVlKGZhbHNlKSxcbiAgICB9O1xuXG4gICAgY29uc3QgeyByZXN1bHQgfSA9IHJlbmRlckhvb2soKCkgPT5cbiAgICAgIHVzZUJhY2tlbmRGYWxsYmFjayhjb25uZWN0V2FsbGV0Rm4sIG9uY2hhaW5GbnMpXG4gICAgKTtcblxuICAgIC8vIFRyeSB0byBjb25uZWN0IHdhbGxldCAoc2hvdWxkIHN1Y2NlZWQpXG4gICAgYXdhaXQgYWN0KGFzeW5jICgpID0+IHtcbiAgICAgIGF3YWl0IHJlc3VsdC5jdXJyZW50LnRyeUNvbm5lY3RXYWxsZXQoKTtcbiAgICB9KTtcblxuICAgIGV4cGVjdChyZXN1bHQuY3VycmVudC51c2VCYWNrZW5kKS50b0JlKGZhbHNlKTtcblxuICAgIC8vIFRlc3QgbW92ZSBvbmNoYWluXG4gICAgY29uc3QgZ3JpZCA9IFtbMF1dO1xuICAgIGNvbnN0IG5ld0dyaWQgPSBhd2FpdCByZXN1bHQuY3VycmVudC5tb3ZlKGdyaWQsIDEsIDEsIDAsIDAsIDEpO1xuICAgIGV4cGVjdChuZXdHcmlkKS50b0VxdWFsKFtbOV1dKTtcbiAgICBleHBlY3Qob25jaGFpbkZucy5tb3ZlKS50b0hhdmVCZWVuQ2FsbGVkKCk7XG5cbiAgICAvLyBUZXN0IGFwcGx5Rm9ybXVsYSBvbmNoYWluXG4gICAgY29uc3QgZm9ybXVsYSA9IHsgaW5wdXQ6IDEsIG91dHB1dDogMiB9O1xuICAgIGNvbnN0IGZvcm11bGFHcmlkID0gYXdhaXQgcmVzdWx0LmN1cnJlbnQuYXBwbHlGb3JtdWxhKGdyaWQsIDEsIDEsIGZvcm11bGEpO1xuICAgIGV4cGVjdChmb3JtdWxhR3JpZCkudG9FcXVhbChbWzhdXSk7XG4gICAgZXhwZWN0KG9uY2hhaW5GbnMuYXBwbHlGb3JtdWxhKS50b0hhdmVCZWVuQ2FsbGVkKCk7XG5cbiAgICAvLyBUZXN0IGNoZWNrQ29tcGxldGlvbiBvbmNoYWluXG4gICAgY29uc3QgY29tcGxldGVkID0gYXdhaXQgcmVzdWx0LmN1cnJlbnQuY2hlY2tDb21wbGV0aW9uKGdyaWQsIFtbMF1dKTtcbiAgICBleHBlY3QoY29tcGxldGVkKS50b0JlKGZhbHNlKTtcbiAgICBleHBlY3Qob25jaGFpbkZucy5jaGVja0NvbXBsZXRpb24pLnRvSGF2ZUJlZW5DYWxsZWQoKTtcbiAgfSk7XG59KTsgIl0sInZlcnNpb24iOjN9